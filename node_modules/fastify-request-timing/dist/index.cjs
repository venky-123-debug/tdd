'use strict';

var fp = require('fastify-plugin');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var fp__default = /*#__PURE__*/_interopDefaultLegacy(fp);

var index = fp__default['default'](async fastify => {
  fastify.addHook('onResponse', async (_, reply) => {
    reply.getResponseTime();
  }); // this has to be called in this hook - to enable all the other getResponseTime calls
  fastify.addHook('onSend', async (_, reply, payload) => {
    reply.header('X-Response-Time', reply.getResponseTime());
    return payload
  });
}, { fastify: '3.x || 4.x', name: 'fastify-response-timing' });

module.exports = index;
